"use strict";(self["webpackChunkgraduate"]=self["webpackChunkgraduate"]||[]).push([[919],{9919:function(e,t,r){r.r(t),r.d(t,{default:function(){return j}});var i=r(3396);const n={class:"map",ref:"container"};function o(e,t,r,o,s,a){return(0,i.wg)(),(0,i.iD)("div",n,null,512)}var s=r(4870),a=r(8277),c=r(9447),u=r(617),h=r(805),m=r(7327),l=(r(1439),r(7585),r(5315),r(7658),r(4901)),p=r(2815),d=r(7133),g=r(5100),y=r(5099),f=r(31),Z=r(409),x=r(2446),v=r(6969),A=r(121),b=r(2954),T=r(8348),w=r(7090),S=r(5363),I=r(3127),L=r(7991),z=r(1562),B=r(4161),D=r(9480),R=r(5497);class _{constructor(e){(0,m.Z)(this,"view",void 0),(0,m.Z)(this,"attributeLocations",void 0),(0,m.Z)(this,"vertexScript",void 0),(0,m.Z)(this,"fragmentScript",void 0),(0,m.Z)(this,"positionHeight",void 0),(0,m.Z)(this,"positionLow",void 0),(0,m.Z)(this,"simpleArray",void 0),(0,m.Z)(this,"rotationArray",void 0),(0,m.Z)(this,"symbolTextureImage",void 0),(0,m.Z)(this,"paletteTextureImage",void 0),(0,m.Z)(this,"u_symbolMatrix",void 0),(0,m.Z)(this,"u_bufferSize",void 0),(0,m.Z)(this,"commandToExecute",void 0),this.view=e.view,this.attributeLocations=e.attributeLocations,this.vertexScript=e.vertexScript,this.fragmentScript=e.fragmentScript,this.positionHeight=e.positionHeight,this.positionLow=e.positionLow,this.simpleArray=e.simpleArray,this.rotationArray=e.rotationArray,this.symbolTextureImage=e.symbolTextureImage,this.paletteTextureImage=e.paletteTextureImage;const t=R.Ue();R.yR(t),R.bA(t,t,[50*window.devicePixelRatio,50*window.devicePixelRatio,1]),this.u_symbolMatrix=t,this.u_bufferSize=e.u_bufferSize}getVertexArray(e){const t=l.Z.createVertexBuffer({context:e,usage:p.Z.STATIC_DRAW,typedArray:new Float32Array(this.simpleArray)}),r=l.Z.createVertexBuffer({context:e,usage:p.Z.STATIC_DRAW,typedArray:new Float32Array(this.positionHeight)}),i=l.Z.createVertexBuffer({context:e,usage:p.Z.STATIC_DRAW,typedArray:new Float32Array(this.positionLow)}),n=l.Z.createVertexBuffer({context:e,usage:p.Z.STATIC_DRAW,typedArray:new Float32Array(this.rotationArray)}),o=new d.Z({context:e,attributes:[{index:1,enabled:!0,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:g.Z.FLOAT,normalize:!1,offseInBytes:0,strideInBytes:4*g.Z.getSizeInBytes(g.Z.FLOAT),instanceDivisor:1},{index:2,enabled:!0,vertexBuffer:r,componentsPerAttribute:3,componentDatatype:g.Z.FLOAT,normalize:!1,offseInBytes:0,strideInBytes:3*g.Z.getSizeInBytes(g.Z.FLOAT),instanceDivisor:1},{index:3,enabled:!0,vertexBuffer:i,componentsPerAttribute:3,componentDatatype:g.Z.FLOAT,normalize:!1,offseInBytes:8*g.Z.getSizeInBytes(g.Z.FLOAT)*this.rotationArray.length,strideInBytes:4*g.Z.getSizeInBytes(g.Z.FLOAT),instanceDivisor:1},{index:4,enabled:!0,vertexBuffer:n,componentsPerAttribute:1,componentDatatype:g.Z.FLOAT,normalize:!1,offseInBytes:12*g.Z.getSizeInBytes(g.Z.FLOAT)*this.rotationArray.length,strideInBytes:g.Z.getSizeInBytes(g.Z.FLOAT),instanceDivisor:1}]});return o}getShaderProgram(e){return y.Z.fromCache({context:e,vertexShaderSource:this.vertexScript,fragmentShaderSource:this.fragmentScript,attributeLocations:this.attributeLocations})}getTexture(e,t){return new f.Z({context:e,source:t,flipY:!1,sampler:new Z.Z({minificationFilter:x.Z.NEAREST,magnificationFilter:v.Z.NEAREST})})}getUniformMap(e){return{symbolTexture:()=>this.getTexture(e,this.symbolTextureImage),paletteTexture:()=>this.getTexture(e,this.paletteTextureImage),u_symbolMatrix:()=>new A.Z(...this.u_symbolMatrix),u_bufferSize:()=>new b.Z(...this.u_bufferSize),u_cartesianCenterHigh:()=>{const e=this.view.camera.position,t=(0,D.LS)(e.x),r=(0,D.LS)(e.y),i=(0,D.LS)(e.z);return new u.Z(t[0],r[0],i[0])},u_cartesianCenterLow:()=>{const e=this.view.camera.position,t=(0,D.LS)(e.x),r=(0,D.LS)(e.y),i=(0,D.LS)(e.z);return new u.Z(t[1],r[1],i[1])},color:()=>new u.Z(Math.random(),Math.random(),Math.random())}}createCommand(e){const t=F({viewport:void 0,depthTest:{enabled:!1},depthMask:!1,blending:{enabled:!1},cull:{enabled:!1,face:T.Z.BACK}});return new w.Z({owner:this,vertexArray:this.getVertexArray(e),count:64,instanceCount:this.rotationArray.length,primitiveType:S.Z.TRIANGLE_STRIP,uniformMap:this.getUniformMap(e),shaderProgram:this.getShaderProgram(e),renderState:I.Z.fromCache(t),pass:L.Z.OPAQUE})}update(e){console.log(123)}isDestroyed(){}destroy(){}}const C=async(e,t,r,i,n,o,s,a)=>{const c=new Promise(((e,t)=>{B.Z.get(r).then((t=>e(t.data)))})),h=new Promise(((e,t)=>{B.Z.get(i).then((t=>e(t.data)))})),m=M(n),l=M(o),p=O(s),d=O(a),g=[],y=[],f=[],Z=[];return Promise.all([h,c,m,l,p,d]).then((r=>{const i=r[0].markers.description;for(let n=0;n<i.length;n++)if(i[n].name===e){const e=Math.ceil(i[n].length/t);for(let t=0;t<r[1].features.length;t++){const o=r[1].features[t],s=u.Z.fromDegrees(o.geometry.coordinates[0],o.geometry.coordinates[1]);for(let t=0;t<e;t++){g.push(i[n].base,i[n].length,t,i[n].ID);const e=(0,D.LS)(s.x),r=(0,D.LS)(s.y),o=(0,D.LS)(s.z);y.push(s.x,s.y,s.z),f.push(e[1],r[1],o[1]),Z.push(0)}}}return[g,y,f,Z,r[2],r[3],r[4],r[5]]}))};async function M(e){const t=await B.Z.get(e).then((e=>e.data));return t}async function O(e){return new Promise(((t,r)=>{const i=new Image;i.src=e,i.onload=()=>{t(i)}})).then((e=>e))}const F=function(e){var t=!0,r=!1,i={viewport:e.viewport,depthTest:e.depthTest,depthMask:e.depthMask,blending:e.blending},n=z.Z.getDefaultRenderState(t,r,i);return n};var P=(0,i.aZ)({setup(){const e=(0,s.iH)();a.Z.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxNjRiYjA0OS0wYTNjLTQwODItYjhmOS1kNTA3NTNlMzhiZWIiLCJpZCI6MTcxNjM3LCJpYXQiOjE2OTcxODE0NDN9.NXFWJtgHshH3lJbrl9QmfjGM3-KRRoQpy5827zZJJV0";const t=async()=>{const t=await C("campfire",64,"/symbol/json/crossroad_NJ.geojson","/symbol/json/tbvs.json","/symbol/shader/symbol3D-primitive.vert.glsl","/symbol/shader/symbol3D-primitive.frag.glsl","/symbol/texture/strip.png","/symbol/texture/palette.png"),r=new c.Z(e.value,{msaaSamples:2,requestRenderMode:!0,maximumRenderTimeChange:1/0});r.camera.setView({destination:u.Z.fromDegrees(118.81259,32.048116,4e5),orientation:{heading:h.Z.toRadians(0),pitch:h.Z.toRadians(-90)}}),r.scene.primitives.add(new _({view:r,attributeLocations:{sampleInfo:1,geoPosition_height:2,geoPosition_low:3,rotation:4},vertexScript:t[4],fragmentScript:t[5],positionHeight:t[1],positionLow:t[2],simpleArray:t[0],rotationArray:t[3],symbolTextureImage:t[6],paletteTextureImage:t[7],u_bufferSize:[r.scene.canvas.width,r.scene.canvas.height]}))};return(0,i.bv)(t),{container:e}}}),N=r(89);const k=(0,N.Z)(P,[["render",o]]);var j=k}}]);
//# sourceMappingURL=919.1f5c22ee.js.map